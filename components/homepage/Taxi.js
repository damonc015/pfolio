import { useEffect, useRef, useContext } from "react";
import { gsap } from "../../util/gsap";
import RoadContext from "../../util/roadmapProvider";

function Taxi(props) {
  const { type, setText } = props;
  const { activeIcon, firstTime, setActiveIcon, setFirstTime } =
    useContext(RoadContext);
  const taxiRef = useRef();
  const taxiTime = useRef();
  useEffect(() => {
    taxiTime.current = gsap.timeline().pause().to(`#${type}Taxi`, {
      duration: 3,
      x: "-100vw",
    });
  }, []);
  useEffect(() => {
    if (firstTime || !taxiTime.current) return;
    taxiTime.current.restart().pause();
  }, [activeIcon]);
  return (
    <>
      <svg
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        id={`${type}Taxi`}
        ref={taxiRef}
        viewBox="0 0 100 100"
      >
        <g
          className="taxiBody"
          onMouseEnter={() => {
            setText(type);
          }}
          onMouseLeave={() => {
            setText();
          }}
          onClick={() => {
            taxiTime.current.play();
            const timeout = setTimeout(() => {
              setFirstTime(false);
              setActiveIcon(type);
            }, 1750);
            return () => {
              clearTimeout(timeout);
            };
          }}
        >
          <path
            d="M1 70.407v12.296h138.175c2.211 1.132 7.995 2.718 13.435 0 5.441-2.718 7.797-5.987 8.294-7.28V58.11l-1.493-4.045-11.777-9.707c-3.87-7.874-12.076-24.203-13.933-26.533-1.858-2.33-6.083-3.99-7.962-4.53l-13.436-.81-.664-11.162H78.464v11.972c-5.64.108-17.384.259-19.242 0-1.857-.259-5.75 2.912-7.464 4.53L36 44.359c-16.09.162-27.204 11.325-29.526 11.163-1.858-.13-2.654 9.87-2.82 14.885H1z"
            fill="#F3CA40"
            stroke="#F3CA40"
          />
          <path
            d="M63.701 82.703a22.8 22.8 0 00-1.818-8.916 23.267 23.267 0 00-5.178-7.558 23.935 23.935 0 00-7.75-5.05 24.411 24.411 0 00-9.14-1.774c-3.137 0-6.243.603-9.14 1.774a23.934 23.934 0 00-7.75 5.05 23.266 23.266 0 00-5.178 7.558 22.8 22.8 0 00-1.818 8.916H63.7zM145.312 82.703c0-3.06-.618-6.09-1.818-8.916a23.277 23.277 0 00-5.178-7.558 23.933 23.933 0 00-7.749-5.05 24.411 24.411 0 00-9.141-1.774c-3.137 0-6.243.603-9.141 1.774a23.933 23.933 0 00-7.749 5.05 23.263 23.263 0 00-5.178 7.558 22.8 22.8 0 00-1.818 8.916h47.772z"
            fill="#F0BE19"
          />
          <path
            d="M105.004 41.123V20.738h22.393c4.114 5.824 7.686 16.017 8.958 20.385h-31.351zM96.213 41.932v-21.68c-11.059.324-33.474.777-34.668 0-1.493-.97-13.768 16.665-12.939 19.415.664 2.2 1.272 2.427 1.493 2.265h46.114z"
            fill="#3A4046"
            stroke="#3A4046"
          />
          <path
            d="M112.137 12.81H78.298V1h33.839v11.81z"
            fill="#fff"
            stroke="#fff"
          />
          <path
            d="M85.975 4.707h-2.24v-1.32h6.1v1.32h-2.24v5.68h-1.62v-5.68zm8.99 4.18h-3.25l-.62 1.5h-1.66l3.12-7h1.6l3.13 7h-1.7l-.62-1.5zm-.51-1.23l-1.11-2.68-1.11 2.68h2.22zm7.605 2.73l-1.69-2.43-1.66 2.43h-1.86l2.59-3.56-2.46-3.44h1.84l1.61 2.27 1.58-2.27h1.75l-2.44 3.38 2.61 3.62h-1.87zm2.504-7h1.62v7h-1.62v-7z"
            fill="#000"
          />
          <path
            d="M11.492 64.721c-.051 2.86-2.454 4.328-5.385 4.278-2.932-.05-2.13-1.546-2.078-4.405.05-2.858-.683-5.19 2.248-5.14 2.931.05 5.266 2.409 5.215 5.267zM160.904 64.259c0 2.68.758 4.53-1.99 4.53-2.749 0-4.977-1.85-4.977-4.53s2.228-4.854 4.977-4.854c2.748 0 1.99 2.173 1.99 4.854z"
            fill="red"
          />
          <path
            fill="#000"
            d="M39.815 46.462h3.649v3.559h-3.649zM43.464 50.022h3.649v3.559h-3.649zM58.393 50.022h3.649v3.559h-3.649zM54.578 46.462h3.65v3.56h-3.65v-3.56zM50.929 50.022h3.649v3.559h-3.65v-3.56z"
          />
          <path
            fill="#000"
            d="M47.445 46.462h3.649v3.559h-3.649zM105.502 46.462h3.649v3.559h-3.649zM109.151 50.022h3.649v3.559h-3.649zM124.08 50.022h3.649v3.559h-3.649zM120.265 46.462h3.649v3.56h-3.649v-3.56zM116.615 50.022h3.65v3.559h-3.65v-3.56z"
          />
          <path
            fill="#000"
            d="M113.132 46.462h3.649v3.559h-3.649zM127.397 46.462h3.649v3.559h-3.649zM131.047 50.022h3.649v3.559h-3.649zM145.975 50.022h3.649v3.559h-3.649zM142.16 46.462h3.65v3.56h-3.65v-3.56zM138.511 50.022h3.649v3.559h-3.649v-3.56z"
          />
          <path
            fill="#000"
            d="M135.028 46.462h3.649v3.559h-3.649zM62.042 46.462h3.649v3.559h-3.649zM65.692 50.022h3.649v3.559h-3.649zM80.62 50.022h3.649v3.559H80.62zM76.805 46.462h3.65v3.56h-3.65v-3.56z"
          />
          <path d="M73.156 50.022h3.65v3.559h-3.65v-3.56z" fill="#000" />
          <path
            fill="#000"
            d="M69.673 46.462h3.649v3.559h-3.649zM84.27 46.462h3.649v3.559H84.27zM87.919 50.022h3.649v3.559h-3.649zM102.848 50.022h3.649v3.559h-3.649zM99.033 46.462h3.649v3.56h-3.65v-3.56z"
          />
          <path d="M95.383 50.022h3.65v3.559h-3.65v-3.56z" fill="#000" />
          <path fill="#000" d="M91.9 46.462h3.649v3.559H91.9z" />
        </g>
        <g className="wheel">
          <ellipse
            cx={39.815}
            cy={80.761}
            rx={17.583}
            ry={17.149}
            fill="#868A8D"
          />
          <ellipse
            cx={39.981}
            cy={80.599}
            rx={11.114}
            ry={10.84}
            fill="#3A4046"
          />
          <ellipse
            cx={39.815}
            cy={80.761}
            rx={6.635}
            ry={6.471}
            fill="#868A8D"
          />
        </g>
        <g className="wheel">
          <ellipse
            cx={121.094}
            cy={80.761}
            rx={17.583}
            ry={17.149}
            fill="#868A8D"
          />
          <ellipse
            cx={121.26}
            cy={80.599}
            rx={11.114}
            ry={10.84}
            fill="#3A4046"
          />
          <ellipse
            cx={121.094}
            cy={80.761}
            rx={6.635}
            ry={6.471}
            fill="#868A8D"
          />
        </g>
      </svg>
    </>
  );
}

export default Taxi;
